

# ๐ก๏ธ Ultimate Secure Setup v3.1 โ Universal Edition

### Ansible Playbook + Helper Scripts for Full Server Hardening

> **Docker + CrowdSec + Smart ClamAV + UFW + Fail2ban + SSH Hardening**
> ูุชูุงูู ูุน: **Kali Linux** / **Debian 11+** / **Ubuntu 20.04+**

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

- [ูุธุฑุฉ ุนุงูุฉ](#-ูุธุฑุฉ-ุนุงูุฉ)
- [ุจููุฉ ุงููุดุฑูุน](#-ุจููุฉ-ุงููุดุฑูุน)
- [ุงููููุฒุงุช](#-ุงููููุฒุงุช)
- [ุงููุชุทูุจุงุช](#-ุงููุชุทูุจุงุช)
- [ุงูุชุซุจูุช ูุงูุงุณุชุฎุฏุงู](#-ุงูุชุซุจูุช-ูุงูุงุณุชุฎุฏุงู)
- [ุงููุชุบูุฑุงุช ุงููุงุจูุฉ ููุชุนุฏูู](#-ุงููุชุบูุฑุงุช-ุงููุงุจูุฉ-ููุชุนุฏูู)
- [ุชูุงุตูู ุงูููููุงุช](#-ุชูุงุตูู-ุงูููููุงุช)
- [ุงูุณูุฑุจุชุงุช ุงููุณุงุนุฏุฉ](#-ุงูุณูุฑุจุชุงุช-ุงููุณุงุนุฏุฉ)
- [ุงุณุชูุดุงู ุงูุฃุฎุทุงุก](#-ุงุณุชูุดุงู-ุงูุฃุฎุทุงุก)
- [ุงูุฃูุงู](#-ููุงุญุธุงุช-ุฃูููุฉ)
- [ุงููุณุงููุฉ](#-ุงููุณุงููุฉ)
- [ุงูุฑุฎุตุฉ](#-ุงูุฑุฎุตุฉ)

---

## ๐ญ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุณุชูุฏุน ูุญุชูู ุนูู ูุฌููุนุฉ ุฃุฏูุงุช ูุชูุงููุฉ ูุชุญููู ุณูุฑูุฑ Linux ุฎุงู ุฅูู ุจูุฆุฉ ููุญุตููุฉ ุจุงููุงูู ูุฌุงูุฒุฉ ููุฅูุชุงุฌ. ูุดูู:

1. **Ansible Playbook** ูุฅุนุฏุงุฏ ุงูุณูุฑูุฑ ุจุงููุงูู ุชููุงุฆูุงู
2. **ุณูุฑุจุช ูุญุต ุดุงูู** ูุชุญูู ูู 30+ ุฎุฏูุฉ ููููู ุฃููู
3. **ุณูุฑุจุช ูุญุต Webhook** ููุชุญูู ูู ุนูู ูุธุงู ุงูุชูุจููุงุช
4. **ุณูุฑุจุช ุฅุตูุงุญ ุชููุงุฆู** ููุนุงูุฌุฉ ุงููุดุงูู ุงูููุชุดูุฉ

ูุชุนุงูู ุงูู Playbook ูุน ุชุฑุชูุจ ุงูุนูููุงุช ุจุฐูุงุก โ ูููุซุจูุช Docker ูููุญุฏูุซ ููุงุนุฏ ุจูุงูุงุช ClamAV **ูุจู** ุชูุนูู ุฌุฏุงุฑ ุงูุญูุงูุฉ UFWุ ููุถูู ุญูุงูุฉ ุงูุงุชุตุงูุงุช ุงููุดุทุฉ ุนุจุฑ ููุงุนุฏ `ESTABLISHED/RELATED` ูููุน ุงููุทุงุน ุฌูุณุฉ SSH ุฃุซูุงุก ุงูุชูููุฐ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              Ultimate Secure Setup               โ
โ                    v3.1                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โ  Docker   โ  โ CrowdSec โ  โ   ClamAV     โ  โ
โ  โ  Engine   โ  โ  + LAPI  โ  โ  Smart Scan  โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โ   UFW    โ  โ Fail2ban โ  โ  SSH Hardened โ  โ
โ  โ Hardened  โ  โ  Active  โ  โ  Key-Only    โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ     Sysctl Kernel Hardening + Swap       โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุจููุฉ ุงููุดุฑูุน

```
setup_servers/
โโโ ultimate-secure-setup.yml   # ๐ฏ Ansible Playbook ุงูุฑุฆูุณู (1342 ุณุทุฑ)
โโโ check-server.sh             # ๐ ุณูุฑุจุช ูุญุต ุดุงูู ููุณูุฑูุฑ (1309 ุณุทุฑ)
โโโ check_webhook.sh            # ๐ ุณูุฑุจุช ูุญุต Webhook (470 ุณุทุฑ)
โโโ fix_ultimate_setup.sh       # ๐ง ุณูุฑุจุช ุฅุตูุงุญ ุชููุงุฆู (1128 ุณุทุฑ)
โโโ README.md                   # ๐ ุงูุชูุซูู
```

| ุงูููู | ุงููุตู | ูุชู ุชุณุชุฎุฏูู |
|-------|-------|-------------|
| `ultimate-secure-setup.yml` | ุงูู Playbook ุงูุฑุฆูุณู โ ููุญุตูู ุงูุณูุฑูุฑ ุจุงููุงูู | ุนูุฏ ุฅุนุฏุงุฏ ุณูุฑูุฑ ุฌุฏูุฏ |
| `check-server.sh` | ูุญุต 30 ูุณู: ูู ุงูุญุฒู ูุงูุฎุฏูุงุช ุฅูู Sysctl ู AppArmor | ููุชุญูู ูู ุตุญุฉ ุงูุณูุฑูุฑ ุจุนุฏ ุงูุฅุนุฏุงุฏ ุฃู ุฏูุฑูุงู |
| `check_webhook.sh` | ูุญุต DNS + SSL + HTTP GET/POST + Headers + Alertmanager config | ููุชุญูู ูู ุนูู ูุธุงู ุงูุชูุจููุงุช |
| `fix_ultimate_setup.sh` | ุฅุตูุงุญ 12 ูุดููุฉ ุดุงุฆุนุฉ ุจูุงุกู ุนูู ูุชุงุฆุฌ ุงููุญุต | ุนูุฏ ูุฌูุฏ ูุดุงูู ุจุนุฏ ุงูุชุดุบูู |

---

## โจ ุงููููุฒุงุช

| ุงููููู | ุงููุตู |
|--------|-------|
| **ุญูุงูุฉ ุงูุงุชุตุงู** | ููุงุนุฏ `ESTABLISHED/RELATED` ุชูุถุงู ูุจู ุชูุนูู UFW ูููุน ููุฏุงู ุฌูุณุฉ SSH |
| **Docker** | ุชุซุจูุช Docker + Compose ูุน ุชูููู ุขูู (`icc: false`, `live-restore`, ุญุฏ ููุณุฌูุงุช) |
| **CrowdSec** | ูุธุงู ุญูุงูุฉ ุชุดุงุฑูู ูุน Firewall Bouncer โ ุซูุงุซ ุทุฑู ุชุซุจูุช ุงุญุชูุงุทูุฉ |
| **ClamAV ุงูุฐูู** | ูุญุต ูููู ุณุฑูุน (Hotspot) + ูุญุต ุฃุณุจูุนู ุดุงูู + ุชุญุฏูุซ ุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช |
| **UFW ุงูููุญูู** | ุณูุงุณุฉ `deny` ูููุงุฑุฏ **ูุงูุตุงุฏุฑ** ูุน ูุงุฆูุฉ ุจูุถุงุก ุฏูููุฉ |
| **Fail2ban** | ุญูุงูุฉ SSH ูู ูุฌูุงุช ุงูููุฉ ุงูุบุงุดูุฉ |
| **SSH Hardening** | ูุถุนุงู: ููู ูุงูู (ุนูุฏ ูุฌูุฏ ููุชุงุญ) ุฃู ูุถุน ุขูู (ุจุฏูู ููุชุงุญ) |
| **Cloudflare Whitelist** | ุฅุถุงูุฉ ุชููุงุฆูุฉ ูุนูุงููู Cloudflare IPv4/IPv6 |
| **ุณูุฑุจุช ุทูุงุฑุฆ** | ุงุณุชุนุงุฏุฉ ุงููุตูู ุจุฃูุฑ ูุงุญุฏ ุนูุฏ ุงูุฅุบูุงู |
| **ูุธุงู ูุฑุงูุจุฉ** | ุชูุฑูุฑ ูููู ุดุงูู ุนู ุตุญุฉ ุงูุณูุฑูุฑ |
| **ุฅุดุนุงุฑุงุช Webhook** | ุชูุจููุงุช ููุฑูุฉ ุนูุฏ ุงูุชุดุงู ุชูุฏูุฏุงุช |
| **ูุญุต ุดุงูู** | ุณูุฑุจุช ููุญุต 30+ ูููู ุฃููู ูุน ุชูููู (A+ ุฅูู D) |
| **ุฅุตูุงุญ ุชููุงุฆู** | ุณูุฑุจุช ูุนุงูุฌ 12 ูุดููุฉ ุดุงุฆุนุฉ ุชููุงุฆูุงู |

---

## ๐ฆ ุงููุชุทูุจุงุช

### ุนูู ุฌูุงุฒู (Control Node)

- **Ansible** 2.12 ุฃู ุฃุญุฏุซ
- ุงุชุตุงู SSH ุจุงูุณูุฑูุฑ ุงููุฏู ุจุตูุงุญูุงุช root

```bash
# ุชุซุจูุช Ansible
pip install ansible

# ุฃู ุนูู Ubuntu/Debian
sudo apt install ansible
```

### ุนูู ุงูุณูุฑูุฑ ุงููุฏู (Managed Node)

- **ูุธุงู ุงูุชุดุบูู:** Kali Linux / Debian 11+ / Ubuntu 20.04+
- **ุงููุนูุงุฑูุฉ:** `amd64` (x86_64)
- **ุฐุงูุฑุฉ RAM:** 1 GB ูุญุฏ ุฃุฏูู (2 GB ูููุตู)
- **ูุณุงุญุฉ ุงููุฑุต:** 10 GB ูุงุฑุบุฉ ูุญุฏ ุฃุฏูู
- **ุงุชุตุงู ุฅูุชุฑูุช** ุฃุซูุงุก ุงูุชุดุบูู ุงูุฃูู
- ุตูุงุญูุงุช **root**

---

## ๐ ุงูุชุซุจูุช ูุงูุงุณุชุฎุฏุงู

### 1. ุงุณุชูุณุงุฎ ุงููุดุฑูุน

```bash
git clone https://github.com/YOUR_USERNAME/ultimate-secure-setup.git
cd ultimate-secure-setup
```

### 2. ุฅุนุฏุงุฏ ููู Inventory

ุฃูุดุฆ ููู `hosts.ini`:

```ini
[target_servers]
my-server ansible_host=203.0.113.50 ansible_user=root ansible_port=22

# ูุนุฏุฉ ุณูุฑูุฑุงุช:
# server-2 ansible_host=203.0.113.51 ansible_user=root
# server-3 ansible_host=203.0.113.52 ansible_user=root
```

### 3. ุชุนุฏูู ุงููุชุบูุฑุงุช

ุงูุชุญ ููู `ultimate-secure-setup.yml` ูุนุฏูู ุงููุณู ุงูุนููู ููุท:

```yaml
vars:
  new_user: "deploy"
  ssh_public_key: "ssh-ed25519 AAAAC3Nz... user@host"
  timezone: "Asia/Riyadh"
  swap_size: "4G"
  reverse_tunnel_port: "9999"
  webhook_url: "https://example.com/webhook/alerts"
```

### 4. ุชุดุบูู ุงูู Playbook

```bash
# ุชุดุบูู ุนุงุฏู
ansible-playbook -i hosts.ini ultimate-secure-setup.yml

# ุชุดุบูู ูุน ุนุฑุถ ุงูุชูุงุตูู
ansible-playbook -i hosts.ini ultimate-secure-setup.yml -v

# ุชุดุบูู ุชุฌุฑูุจู (ุจุฏูู ุชุทุจูู)
ansible-playbook -i hosts.ini ultimate-secure-setup.yml --check

# ุชุดุบูู ุนูู ุณูุฑูุฑ ูุงุญุฏ ููุท
ansible-playbook -i hosts.ini setup.yml --limit my-server
```

---

## โ๏ธ ุงููุชุบูุฑุงุช ุงููุงุจูุฉ ููุชุนุฏูู

### ูุนูููุงุช ุงููุณุชุฎุฏู

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `new_user` | `deploy` | ุงุณู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ |
| `ssh_public_key` | `""` | ุงูููุชุงุญ ุงูุนุงู SSH (ุงุฎุชูุงุฑู) |

### ุฅุนุฏุงุฏุงุช ุงููุธุงู

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `timezone` | `UTC` | ุงูููุทูุฉ ุงูุฒูููุฉ |
| `swap_size` | `4G` | ุญุฌู ููู Swap |

### ุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `reverse_tunnel_port` | `9999` | ูููุฐ ุงูููู ุงูุนูุณู |
| `webhook_url` | `""` | ุฑุงุจุท Webhook ููุชูุจููุงุช |
| `enable_cloudflare_whitelist` | `true` | ุชูุนูู ุงููุงุฆูุฉ ุงูุจูุถุงุก ูู Cloudflare |

### ุงูููุงูุฐ ุงููุณููุญ ุจูุง โ ุงููุงุฑุฏ

```yaml
allowed_inbound_ports:
  - { port: "22", proto: "tcp", comment: "SSH access" }
  - { port: "41641", proto: "udp", comment: "Tailscale VPN" }
  # ุฃุถู ููุงูุฐ ุฅุถุงููุฉ:
  # - { port: "8080", proto: "tcp", comment: "Web App" }
  # - { port: "8069", proto: "tcp", comment: "Odoo" }
```

### ุงูููุงูุฐ ุงููุณููุญ ุจูุง โ ุงูุตุงุฏุฑ

```yaml
allowed_outbound_ports:
  - { port: "53", proto: "udp", comment: "DNS queries" }
  - { port: "53", proto: "tcp", comment: "DNS queries TCP" }
  - { port: "80", proto: "tcp", comment: "HTTP updates" }
  - { port: "443", proto: "tcp", comment: "HTTPS secure" }
  - { port: "123", proto: "udp", comment: "NTP time sync" }
```

### ClamAV

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `clamav_db_mirror` | `database.clamav.net` | ูุฑุขุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| `clamav_quarantine_dir` | `/root/quarantine` | ูุฌูุฏ ุงูุญุฌุฑ |
| `clamav_full_scan_day` | `5` | ููู ุงููุญุต ุงูุดุงูู (5=ุงูุฌูุนุฉ) |
| `clamav_daily_scan_hour` | `2` | ุณุงุนุฉ ุงููุญุต ุงููููู |
| `clamav_full_scan_hour` | `3` | ุณุงุนุฉ ุงููุญุต ุงูุฃุณุจูุนู |

### Docker

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `docker_log_max_size` | `10m` | ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุณุฌู ุงูุญุงููุฉ |
| `docker_log_max_file` | `3` | ุนุฏุฏ ูููุงุช ุงูุณุฌู ุงูููุญุชูุธ ุจูุง |

### Fail2ban

| ุงููุชุบูุฑ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `fail2ban_bantime` | `86400` | ูุฏุฉ ุงูุญุธุฑ ุจุงูุซูุงูู (24 ุณุงุนุฉ) |
| `fail2ban_findtime` | `600` | ูุงูุฐุฉ ุงูุจุญุซ (10 ุฏูุงุฆู) |
| `fail2ban_maxretry` | `3` | ุนุฏุฏ ุงููุญุงููุงุช ูุจู ุงูุญุธุฑ |

### CrowdSec

```yaml
crowdsec_monitored_containers:
  - { name: "traefik_gateway", type: "traefik" }
  - { name: "app", type: "syslog" }
  - { name: "db", type: "pgsql" }

crowdsec_collections:
  - crowdsecurity/linux
  - crowdsecurity/traefik
  - crowdsecurity/postgresql
  - crowdsecurity/http-cve
  - crowdsecurity/base-http-scenarios
```

---

## ๐ ุชูุงุตูู ุงูููููุงุช

### ุฌุฏุงุฑ ุงูุญูุงูุฉ UFW

ุงูุณูุงุณุฉ ุงูุงูุชุฑุงุถูุฉ ุตุงุฑูุฉ: **ุญุธุฑ ุงููุงุฑุฏ ูุงูุตุงุฏุฑ** ูุน ุงูุณูุงุญ ููุท ุจุงูููุงูุฐ ุงููุญุฏุฏุฉ. ูุชู ุชุนุฏูู `/etc/ufw/before.rules` ูุฅุถุงูุฉ ูุงุนุฏุฉ `ESTABLISHED/RELATED` ููุงุชุตุงูุงุช ุงูุตุงุฏุฑุฉุ ููุง ูุถูู ุนุฏู ุงููุทุงุน ุงูุฌูุณุงุช ุงููุดุทุฉ (SSH, tunnels) ุนูุฏ ุชูุนูู ุงูุฌุฏุงุฑ.

```
Incoming:  DENY (default) โ Allow: SSH, Tailscale, Reverse Tunnel
Outgoing:  DENY (default) โ Allow: DNS, HTTP, HTTPS, NTP, Tunnel
                           โ Allow: ESTABLISHED/RELATED (before.rules)
Routed:    ALLOW (for Docker)
Docker:    docker0 bridge allowed
```

### ClamAV โ ุงููุญุต ุงูุฐูู

ูุนูู ClamAV ุจุฏูู daemon ูุชูููุฑ ุงูููุงุฑุฏ. ูุธุงู ุงููุญุต ุฐูู:

- **ููููุงู** โ ูุญุต ุณุฑูุน ูููุฌูุฏุงุช ุงูุญุณุงุณุฉ: `/home`, `/tmp`, `/var/lib/docker/volumes`, `/etc`, `/var/www`, `/opt`
- **ุฃุณุจูุนูุงู** โ ูุญุต ุดุงูู ููุงูู ุงููุธุงู `/` (ูุน timeout 14 ุณุงุนุฉ)
- **ูู 4 ุณุงุนุงุช** โ ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูููุนุงุช

ุงููุญุต ูุนูู ุจุฃููููุฉ ููุฎูุถุฉ (`nice -n 19`, `ionice -c 3`) ูุชูููู ุงูุชุฃุซูุฑ ุนูู ุงูุฃุฏุงุก.

### CrowdSec

ูุธุงู ุญูุงูุฉ ุชุดุงุฑูู ูุฑุงูุจ ุณุฌูุงุช ุงููุธุงู ูุญุงููุงุช Docker. ูุชู ุชุซุจูุช Firewall Bouncer ุจุซูุงุซ ุทุฑู ุงุญุชูุงุทูุฉ:

1. ุงูุญุฒูุฉ ุงูููุญุฏุฉ `crowdsec-firewall-bouncer`
2. ุงูุญุฒูุฉ ุงููุชุฎุตุตุฉ (iptables ุฃู nftables)
3. ุงูุชุซุจูุช ูู GitHub ูููุงุฐ ุฃุฎูุฑ

### ูุถุน SSH ุงูุขูู

ุงูู Playbook ููุชุดู ุชููุงุฆูุงู ูุฌูุฏ ููุชุงุญ SSH:

- **ููุชุงุญ ููุฌูุฏ** โ ููู ูุงูู: `PasswordAuthentication no` + `PermitRootLogin no`
- **ุจุฏูู ููุชุงุญ** โ ูุถุน ุขูู: `PasswordAuthentication yes` + `PermitRootLogin prohibit-password` ูุน ุชุญุฐูุฑ ูุงุถุญ

---

## ๐ ุงูุณูุฑุจุชุงุช ุงููุณุงุนุฏุฉ

### ๐ ุณูุฑุจุช ุงููุญุต ุงูุดุงูู (`check-server.sh`)

ุณูุฑุจุช ุดุงูู ููุญุต **30 ูุณู** ูู ููููุงุช ุงูุณูุฑูุฑ ููุนุทู ุชูููู ููุงุฆู:

```bash
sudo bash check-server.sh
```

**ุงูุฃูุณุงู ุงูุชู ููุญุตูุง:**

| # | ุงููุณู | ุงููุตู |
|---|-------|-------|
| 1 | ุงูุญุฒู ุงูุฃุณุงุณูุฉ | 40+ ุญุฒูุฉ ูุทููุจุฉ |
| 2 | SSH | ุฅุนุฏุงุฏุงุช ุงูุฃูุงู (Root Login, Key Auth, MaxAuthTries) |
| 3 | UFW | ุญุงูุฉ ุงูุฌุฏุงุฑ ูููุงุนุฏู |
| 4 | Fail2Ban | Jails ุงููุดุทุฉ ูุฅุญุตุงุฆูุงุช ุงูุญุธุฑ |
| 5 | ClamAV | Daemon + Freshclam + ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| 6 | Rootkit Hunter | rkhunter + chkrootkit |
| 7 | Lynis | ุชุฏููู ุฃููู + Hardening Index |
| 8 | AIDE | ูุดู ุชุบููุฑ ุงููููุงุช |
| 9 | ุฃุฏูุงุช ุงููุฑุงูุจุฉ | Prometheus, Grafana, Alertmanager, Netdata, Monit |
| 10 | ุณูุฑุจุช ุงููุฑุงูุจุฉ | ุงููุฎุตุต + Systemd Timers |
| 11 | Docker | ุงูุญุงููุงุช + Compose |
| 12 | ุฎูุงุฏู ุงูููุจ | Nginx + Apache |
| 13 | SSL/TLS | ุดูุงุฏุงุช Let's Encrypt + ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู |
| 14 | ููุงุนุฏ ุงูุจูุงูุงุช | MySQL, PostgreSQL, Redis, MongoDB |
| 15 | ุงููุณุฎ ุงูุงุญุชูุงุทู | ุฃุฏูุงุช + ุฌุฏููุฉ |
| 16 | ุฅุฏุงุฑุฉ ุงูุณุฌูุงุช | Logrotate + Rsyslog + Journal |
| 17 | Auditd | ุชุฏููู ุงููุธุงู |
| 18 | Sysctl | 12 ุฅุนุฏุงุฏ ุฃููู ููู Kernel |
| 19 | AppArmor/SELinux | ุญูุงูุฉ ุงูุชุทุจููุงุช |
| 20 | ุงูุดุจูุฉ | ูุงุฌูุงุช + DNS + ุงุชุตุงู ุงูุฅูุชุฑูุช |
| 21 | ุงููุณุชุฎุฏููู | ุตูุงุญูุงุช + UID 0 + ูููุงุช ุญุณุงุณุฉ |
| 22 | ุงูููุงุฑุฏ | ุงููุฑุต + ุงูุฐุงูุฑุฉ + Load Average |
| 23 | NTP | ูุฒุงููุฉ ุงูููุช |
| 24 | ุงูุชุญุฏูุซุงุช ุงูุชููุงุฆูุฉ | Unattended Upgrades |
| 25 | WAF | ModSecurity |
| 26 | VPN | WireGuard + OpenVPN |
| 27 | Cron Jobs | ุงูููุงู ุงููุฌุฏููุฉ |
| 28 | ุฃุฏูุงุช ุฃูููุฉ | Tripwire, Tiger, Debsums |
| 29 | ุฎุฏูุงุช ูุงุดูุฉ | systemd failed services |
| 30 | ุงูููุงูุฐ | ุงูููุงูุฐ ุงูููุชูุญุฉ ูุงููุณุชูุน ุนูููุง |

**ูุธุงู ุงูุชูููู:**
- ๐ **A+ (90%+)** โ ุญูุงูุฉ ููุชุงุฒุฉ
- โญ **A (80%+)** โ ุญูุงูุฉ ุฌูุฏุฉ ุฌุฏุงู
- ๐ **B (70%+)** โ ุญูุงูุฉ ุฌูุฏุฉ
- โก **C (60%+)** โ ูุญุชุงุฌ ุชุญุณูู
- โ๏ธ **D (<60%)** โ ูุญุชุงุฌ ุฅุตูุงุญ ุนุงุฌู

### ๐ ุณูุฑุจุช ูุญุต Webhook (`check_webhook.sh`)

ูุชุญูู ูู ุนูู ูุธุงู ุงูุชูุจููุงุช ุจุงููุงูู:

```bash
sudo bash check_webhook.sh
```

**ููุญุต:**
1. **DNS Resolution** โ ุญู ุงุณู ุงููุทุงู
2. **ุงูุงุชุตุงู** โ ping + ูุญุต ุงูุจูุฑุชุงุช 80/443
3. **ุดูุงุฏุฉ SSL** โ ุตูุงุญูุฉ + ุชุงุฑูุฎ ุงูุงูุชูุงุก
4. **HTTP GET** โ ุงุณุชุฌุงุจุฉ ุงูู webhook
5. **HTTP POST** โ ุฅุฑุณุงู ุชูุจูู ุงุฎุชุจุงุฑู
6. **Response Headers** โ ูุญุต ุงูู headers
7. **ุงูุฎุฏูุงุช ุงููุญููุฉ** โ Nginx + Alertmanager
8. **ุฅุนุฏุงุฏุงุช Alertmanager** โ ุงูุชุญูู ูู ุงูู config

> **ููุงุญุธุฉ:** ุนุฏูู ุงููุชุบูุฑ `WEBHOOK_URL` ูู ุจุฏุงูุฉ ุงูุณูุฑุจุช ููุทุงุจู ุฑุงุจุท ุงูู webhook ุงูุฎุงุต ุจู.

### ๐ง ุณูุฑุจุช ุงูุฅุตูุงุญ ุงูุชููุงุฆู (`fix_ultimate_setup.sh`)

ูุนุงูุฌ **12 ูุดููุฉ ุดุงุฆุนุฉ** ุชููุงุฆูุงู:

```bash
sudo bash fix_ultimate_setup.sh
```

| # | ุงููุดููุฉ | ุงูุฅุตูุงุญ |
|---|---------|---------|
| 1 | ุญุฒู ููููุฏุฉ | ุชุซุจูุช 20+ ุญุฒูุฉ |
| 2 | ClamAV ูุงุดู | ุฅุตูุงุญ freshclam + daemon + ุงูุตูุงุญูุงุช |
| 3 | CrowdSec ูุชููู | ุฅุนุงุฏุฉ ุชุซุจูุช + ุฅุนุฏุงุฏ Collections |
| 4 | AIDE Daily Check | ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช + ุฅุตูุงุญ ุงูุฎุฏูุฉ |
| 5 | UFW ุบูุฑ ููุนู | ุชูุนูู ูุน ููุงุนุฏ SSH/HTTP/HTTPS |
| 6 | X11Forwarding ููุนู | ุชุนุทููู ูู SSH config |
| 7 | Sysctl ุฎุงุทุฆ | ุฅุตูุงุญ 3 ุฅุนุฏุงุฏุงุช ุฃูููุฉ |
| 8 | NTP ุบูุฑ ููุนู | ุชูุนูู ูุฒุงููุฉ ุงูููุช |
| 9 | Nginx | ุฅุนุฏุงุฏ Headers ุฃูููุฉ |
| 10 | Monit + Lynis | ุฅุนุฏุงุฏ ุงููุฑุงูุจุฉ + ุงูุชุฏููู ุงูุฃุณุจูุนู |
| 11 | Certbot | ุฅุนุฏุงุฏ ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู |
| 12 | Fail2Ban + ุงููุฑุงูุจุฉ | ุชุญุณูู ุงูููุงุนุฏ + ุณูุฑุจุช ูุฑุงูุจุฉ ูุชูุฏู |

### ุณูุฑุจุช ุงูุทูุงุฑุฆ

```bash
# ุนูุฏ ููุฏุงู ุงููุตูู โ ุดุบูู ูู ูููุณูู ุงูุณูุฑูุฑ (VNC / Physical / KVM)
/usr/local/bin/emergency_ufw_fix.sh
```

ูููู ุจุฅุนุงุฏุฉ UFW ุฅูู ุฅุนุฏุงุฏุงุช ุขููุฉ ูุน ุงูุณูุงุญ ุจู SSH ูุงูููู ุงูุนูุณู.

### ุณูุฑุจุช ุงููุฑุงูุจุฉ

```bash
# ุชุดุบูู ูุฏูู
/usr/local/bin/system_monitor.sh

# ุงูุชูุฑูุฑ ุงูุชููุงุฆู (ูู 5 ุฏูุงุฆู ุจุนุฏ ุชุดุบูู fix_ultimate_setup.sh)
cat /tmp/system_report.txt
```

ูุนุฑุถ: ุงุณุชุฎุฏุงู ุงููุฑุตุ ุงูุฐุงูุฑุฉุ ุญุงูุฉ Dockerุ ุขุฎุฑ ูุญุต ClamAVุ ุฅุญุตุงุฆูุงุช CrowdSecุ ุญุงูุฉ UFW ู Fail2ban.

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ููุฏุช ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ ุจุนุฏ ุงูุชุดุบูู

ุงุชุตู ุนุจุฑ **ูููุณูู VNC** ูู ููุญุฉ ุชุญูู ูุฒูุฏ ุงูุงุณุชุถุงูุฉุ ุซู:

```bash
/usr/local/bin/emergency_ufw_fix.sh
```

### CrowdSec ูู ููุซุจูุช

```bash
# ุชุญูู ูู ุงูุญุงูุฉ
cscli version
cscli bouncers list

# ุฅุนุงุฏุฉ ุงูุชุซุจูุช ูุฏููุงู
curl -s https://install.crowdsec.net | bash
apt update && apt install crowdsec
```

### Docker ูุง ูุนูู

```bash
systemctl status docker
journalctl -u docker --no-pager -n 50

# ุฅุนุงุฏุฉ ุงูุชุดุบูู
systemctl restart docker
```

### ClamAV โ ุงูุชุญุฏูุซ ูุดู

```bash
# ุชุญุฏูุซ ูุฏูู
freshclam --verbose

# ุชุญูู ูู ุงูุณุฌู
cat /var/log/clamav/freshclam.log
```

### UFW ูุญุธุฑ ุงุชุตุงูุงุช ูุทููุจุฉ

```bash
# ุนุฑุถ ุงูููุงุนุฏ
ufw status numbered

# ุฅุถุงูุฉ ูููุฐ
ufw allow 8080/tcp comment "My App"

# ุนุฑุถ ุงูุณุฌูุงุช
tail -f /var/log/ufw.log
```

### ุณูุฑุจุช ุงููุญุต ููุธูุฑ ุชูููู ููุฎูุถ

```bash
# ุดุบูู ุณูุฑุจุช ุงูุฅุตูุงุญ ุงูุชููุงุฆู
sudo bash fix_ultimate_setup.sh

# ุซู ุฃุนุฏ ุงููุญุต
sudo bash check-server.sh
```

---

## ๐ ููุงุญุธุงุช ุฃูููุฉ

> **ุชุญุฐูุฑ:** ูุง ุชูุดุบูู ูุฐุง ุงูู Playbook ุนูู ุณูุฑูุฑ ุฅูุชุงุฌ ุจุฏูู ุงุฎุชุจุงุฑู ุฃููุงู ุนูู ุจูุฆุฉ ุชุฌุฑูุจูุฉ.

- ุชุฃูุฏ ูู ูุฌูุฏ **ููุชุงุญ SSH** ูุจู ุงูุชุดุบูู ูุชูุนูู ุงูููู ุงููุงูู
- ุงุญุชูุธ ุจุทุฑููุฉ ูุตูู ุจุฏููุฉ (VNC / KVM / Console) ุฏุงุฆูุงู
- ุณูุงุณุฉ ุงูุตุงุฏุฑ `deny` ูุฏ ุชููุน ุจุนุถ ุงูุชุทุจููุงุช โ ุฃุถู ุงูููุงูุฐ ุงููุงุฒูุฉ ูู `allowed_outbound_ports`
- ุบููุฑ `reverse_tunnel_port` ูู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ `9999`
- ูุง ุชุชุฑู `webhook_url` ูุงุฑุบุงู ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ โ ูุนูู ุงูุชูุจููุงุช
- ุนุฏูู `WEBHOOK_URL` ูู `check_webhook.sh` ููุทุงุจู ุฑุงุจุทู ูุจู ุงุณุชุฎุฏุงูู
- ุฑุงุฌุน `/root/setup_summary.txt` ุจุนุฏ ูู ุชุดุบูู

---

## ๐ค ุงููุณุงููุฉ

ุงููุณุงููุงุช ููุฑุญูุจ ุจูุง! ุฅุฐุง ูุฌุฏุช ูุดููุฉ ุฃู ูุฏูู ุงูุชุฑุงุญ:

1. ุงูุชุญ **Issue** ููุตู ุงููุดููุฉ ุฃู ุงูุงูุชุฑุงุญ
2. ุฃูุดุฆ **Fork** ูู ุงููุดุฑูุน
3. ุฃูุดุฆ ูุฑุน ุฌุฏูุฏ: `git checkout -b feature/my-feature`
4. ูุฏูู ุงูุชุนุฏููุงุช: `git commit -m "Add my feature"`
5. ุงุฏูุน ุงููุฑุน: `git push origin feature/my-feature`
6. ุงูุชุญ **Pull Request**

---

## ๐ ุงูุฑุฎุตุฉ

ูุฐุง ุงููุดุฑูุน ูุฑุฎูุต ุชุญุช ุฑุฎุตุฉ [MIT](LICENSE).

---

<div align="center">

**ุตููู ุจุนูุงูุฉ ูุญูุงูุฉ ุณูุฑูุฑุงุชู** ๐ก๏ธ

ุฅุฐุง ุฃุนุฌุจู ุงููุดุฑูุนุ ูุง ุชูุณู โญ

</div>
